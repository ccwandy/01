<!DOCTYPE html>
<!-- saved from url=(0106)https://pnt16.apitech.com.tw/WebAgenda/apeform.do?freqAPID=FAP02231713248681260&artID=ART02921713248681264 -->
<html translate="no"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- /EIP2016/skins/default/tiles/components/GlobalImport.jsp -->


















<!-- add for AF-7014_v2 -->

<!-- AF-8209 add by Sylvia -->

<!-- AF-8209 add by Sylvia end-->



    
    
        
            
            <title>應用程式表單</title>
        
    


<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--<base href="https://pnt16.apitech.com.tw/WebAgenda/">--><base href=".">
	<script type="text/javascript">
		var urlBase="https://pnt16.apitech.com.tw/WebAgenda/";
	</script>
<link rel="shortcut icon" href="https://pnt16.apitech.com.tw/WebAgenda/EIP2016/style/default_1/image/favicon.ico">
<link rel="apple-touch-icon" href="https://pnt16.apitech.com.tw/WebAgenda/image/icon/iphone_icon_114x114.png">

<!-- add by yanli AF-8425 2023/8/7 -->

	<!-- AF-8105 start, modified by tammyyang (add charset="UTF-8" to complement the security of content-type setting) -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/beforeInit.css"><!-- keep this as first one -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/bootstrap.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/all.min.css"><!--update by bin 20180730 upgrate version to 5.2.0 -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/style.css"><!-- af5,20210621,luke -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/animate.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/toastr.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/style(1).css">
	<!-- link type="text/css" charset="UTF-8" rel="stylesheet" href="EIP2016/css/plugins/pace/pace.css?reLoadCache=1754887468000"/-->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/sweetalert2.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/custom.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/tabdrop.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/bootstrap-submenu.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/jquery.datepicker.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/switchery.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/nouislider.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/bootstrap-table.min.css">
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/jquery.bootstrap-touchspin.min.css"><!-- UP-1633, by Jason 20190326 -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/jquery.bootstrap-touchspin.custom.css"><!-- UP-1633, by Jason 20190326 -->
	<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/general.css"><!-- keep this as last one -->
	<!-- AF-8105 end -->

<!-- AF-8425 end -->
<!-- AF-8472 add by sylvia -->
<style>
	.toast {
		font-size:15px;
	}
</style>
<!-- AF-8472 end-->

<!-- add by abin for footer div while cover filter div or scrollbar  -->
<!-- delete by abin; Do not remember which AP use it 20180625
<style>
	#page-wrapper>.row:last-child{
		padding-bottom: 40px;
	}
	.wrapper-content {
		position: relative;
		z-index: 2;
	}
</style>
-->
<script type="text/javascript">
    if (/MSIE \d|Trident.*rv:/.test(navigator.userAgent) || /(iphone|ipod|ipad).* os 8_/.test(navigator.userAgent.toLowerCase())) { //UP-934, AF-5699 check if IE 11 or IOS8, it means not supporting the es6. by Jason 20170315
    	document.write('<script src="EIP2016/js/plugins/es6-promise/es6-promise.min.js"><\/script>');
    	document.write('<script src="EIP2016/js/plugins/es6-shim/es6-shim.min.js"><\/script>');
    }
</script>
<script type="text/javascript" language="javascript" charset="UTF-8" src="./應用程式表單_files/jquery.js.下載"></script><script type="text/javascript" language="javascript" charset="UTF-8" src="./應用程式表單_files/jqueryMigrate.min.js.下載"></script>
<script type="text/javascript" language="javascript" charset="UTF-8" src="./應用程式表單_files/jquery-ui.min.js.下載"></script>
<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/jquery-ui.min.css">
<!-- add by yanli AF-8425 2023/8/7 -->

	<!-- AF-8105 start, modified by tammyyang (add type="text/javascript" and charset="UTF-8" to complement the security of content-type setting) -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/beforeInit.js.下載"></script><!-- keep this as first one, but behind the es6 js. -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/system.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/menu.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/flowringDialog.js.下載"></script> <!-- Since AF4.0  Jared 20150925 -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/calwin.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/uniportalFunction.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/roleTreeModal.js.下載"></script> <!-- modify for AF-8120 -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/roleTreeBoxOption.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/bootstrap.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/inspinia.js.下載"></script> <!-- modify for AF-7014_v2 -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/metisMenu.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/jquery.slimscroll.min.js.下載"></script>
	<!-- script type="text/javascript" charset="UTF-8" src="EIP2016/js/plugins/pace/pace.min.js"></script-->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/toastr.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/sweetalert2.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/icheck.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/bootstrap-tabdrop.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/clipboard.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/bootstrap-submenu.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/switchery.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/nouislider.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/wNumb.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/bootstrap-table.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/bootstrap-table-TW.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/jquery.bootstrap-touchspin.min.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/datepicker_lang_TW.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/jquery.datepicker.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/flowringSpinner.js.下載"></script>
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/push.js.下載"></script><!-- UP-970, by Jason 20190429 -->
	<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/jquery.form.js.下載"></script>
	<!-- AF-8105 end -->

<script>
	var reloadCacheTime = '?reLoadCache=1754887468000'; //UP-970, by Jason 20190430
	var toastSeat = "toast-top-right";//AF-8472 add sylvia
	//declare from EIP2016/js/uniportalFunction.js
	eipBaseOkText = '確認';
	eipBaseCancelText = '取消';
	eipBaseCloseText = '關閉';
	eipBaseDataNotComplete = '資料不完整';
	//declare from EIP2016/roletree/js/rolewin.js
	eipRoleTreeTitle = '組織樹';
	eipShowUserDetailInfoTitle = '人員資料搜尋';
	
// 	Pace.on('start', function(){
// 		$('body').append('<div class="pace-modal"></div>');
		
// 		paceObserver();
// 	});
// 	Pace.on('hide', function(){
// 		$('.pace-modal').fadeOut(400, function() {
//         	$(this).remove();
//         });
// 	});
	Pace = {
		start: function() {},
		restart: function() {},
		stop: function() {}
	};
	
	importIOSSelectStyle();
	
	$(function() {
		initBaseView();
		
		initPasswordCheckAlert();

		initCopyToClipboardBtn();
		
		initJQueryAjaxSetup();
		
		$(window).load(function() {
			// this code will run after all other $(document).ready() scripts
	        // have completely finished, AND all page elements are fully loaded.
	        initICheck('i-checks');
			
	        initSwitchery('.js-switch');
	    });
	});
	
	function initBaseView() {
		//to sovle menu ui problem on mobile browser
		$('body.fixed-sidebar .navbar-static-side').removeClass('fr_hidden');
		
		$('[data-toggle="tooltip"]').tooltip();
		
		$('.nav-pills, .nav-tabs').tabdrop({
			text: '<i class="fas fa-bars"></i>'
		});
	}
	
	function initPasswordCheckAlert() {
		
	}
	
	function initCopyToClipboardBtn() {
		new Clipboard('.fr_copy_btn');
	}
	
	function importIOSSelectStyle() {
		if(isIOSDevice || isSafari) { <!-- AF-8105, modified by tammyyang (add charset="UTF-8" to complement the security of content-type setting) -->
	    	document.write('<link type="text/css" charset="UTF-8" rel="stylesheet" href="EIP2016/style/default_1/css/iosSelect.css?reLoadCache=1754887468000"/>');
	    }
	}
	//if progress bar is greater than 97, force to close the progress bar. By Jason 20180720
// 	function paceObserver() {
// 		let mObserver;
// 		let moTargetNode = document.querySelector('.pace .pace-progress');
// 		let moConfig = { attributes: true, attributeOldValue: true };

// 		let moCallback = function(mutationsList) {
// 			//for (var mutation of mutationsList) {
// 		    for (let key in mutationsList) { // for IE 11
// 		    	let mutation = mutationsList[key];
// 		        if (mutation.type == 'attributes') {
// 		            if (mutation.attributeName == 'data-progress') {
// 		            	let dataProgress = mutation.oldValue;
// 		            	dataProgress = parseInt(dataProgress);
// 		            	if (!isNaN(dataProgress) && dataProgress >= 97) {
// 		            		Pace.stop();
// 		            		mObserver.disconnect();
// 		            	}
// 		            }
// 		        }
// 		    }
// 		};

// 		mObserver = new MutationObserver(moCallback);
// 		mObserver.observe(moTargetNode, moConfig);
// 	}
	
	//UP-1215, by Jason 20190617
	function initJQueryAjaxSetup() {
		$.ajaxSetup({
			beforeSend: function (jqXHR) {
				jqXHR.setRequestHeader("FR_JQ_XHR", "FR_JQ_XHR");//添加header 標識ajax請求
		    },
			statusCode: {
		        504: function(){
		        	window.location.href = "relogin.do";
		        }
		    },
		});
	}
</script>

    <!-- AF-8105, modified by tammyyang (add charset="UTF-8" to complement the security of content-type setting) -->  
    <script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/jquery.ui.sortable.js.下載"></script> 
	
	<script type="text/javascript">
	
	function removeOnbeforeunload() {
		window.onbeforeunload = null;
	}
	//add for AF-6776 2018/11/27
	var _eform_check=false;
	function unloadCheck(arg){
		if (_eform_check==true){
			if (confirm(arg)){
				suspendTaskAfterClosingBrowser();
			} else {	//add by yhtseng, 2004/12/27
				unlockCoSign();
			}
		}
	}
	//end for AF-6776
	</script>
	<!-- start add by yanli AF-8155 -->
	<style>
	    ._modal {
	        display:    none;
	        position:   fixed;
	        z-index:    1000;
	        top:        0;
	        left:       0;
	        height:     100%;
	        width:      100%;
	        background: rgba( 0, 0, 0, 0.1 ) 
	                    url('image/ajax-loader.gif') 
	                    50% 50% 
	                    no-repeat;
	    }
	    body._loading ._modal{
	        display:    block;
	    }
    </style>
    <!-- end add by yanli AF-8155 -->

</head>
<body class="pagebody fixed-sidebar fixed-nav fixed-nav-basic mini-navbar" onload="removeOnbeforeunload()" onunload="unloadCheck(&#39;檔案未存檔,是否存檔?&#39;)"> <!-- add 'mini-navbar' by fenping.zou,for AF-7014_v2 -->
    <div id="wrapper">
    <!-- AF-7378, add by yihong -->
    <div id="overlay" class="jsp-overlay" style="position: fixed; width: 100%; height: 100%; left: 0; top: 0; background: rgba(40, 40, 40, 0.3); z-index: 3000; display:none">
        <div id="canvasDiv" class="canvasSelect"><canvas width="1920" height="957" id="canvas"></canvas></div>
        <input id="txt_openBiggerItemID" type="text" style="display:none" value="">
        <input id="txt_openBiggerItemName" type="text" style="display:none" value="">
        <div id="signatureMessage" style=" position: fixed; top: 4vh; right: 2vw; width: 10%; color: red; font-size: 20px; font-weight: bold; background-color: yellow; text-align: center;">請在灰色區塊簽名</div>
        <input id="btn_clear" type="button" style=" position: fixed; bottom: 4vh; right: 2vw; width: 60px; color: black;" value="清除">
        <input id="btn_cancel" type="button" style=" position: fixed; bottom: 8vh; right: 2vw; width: 60px; color: black;" value="取消">
        <input id="btn_submit" type="button" style=" position: fixed; bottom: 12vh; right: 2vw; width: 60px; color: black;" value="確定
">
<script language="javascript">
        
        var canvasDiv = document.getElementById('canvasDiv');
        var canvas = document.createElement('canvas');
        var screenwidth = (window.innerWidth > 0) ? window.innerWidth : screen.width;
        var screenheight = (window.innerHeight > 0) ? window.innerHeight : screen.height;
        document.addEventListener('touchmove', onDocumentTouchMove, false);
        var point = {};
        point.notFirst = false;
        canvas.setAttribute('width', screenwidth);
        canvas.setAttribute('height', screenheight);
        canvas.setAttribute('id', 'canvas');
        canvasDiv.appendChild(canvas);
        if (typeof G_vmlCanvasManager != 'undefined') {
            canvas = G_vmlCanvasManager.initElement(canvas);
        }
        var context = canvas.getContext("2d");
        var img = new Image();
        
        img.onload = function() {
            var ptrn = context.createPattern(img, 'repeat');
            context.fillStyle = ptrn;
            context.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        canvas.addEventListener("touchstart", function(e) {
            var mouseX = e.touches[0].pageX - this.offsetLeft;
            var mouseY = e.touches[0].pageY - this.offsetTop;
            paint = true;
            addClick(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop);
            redraw();
        });
        
        canvas.addEventListener("touchend", function(e) {
            paint = false;
        });
        
        canvas.addEventListener("touchmove", function(e) {
            if (paint) {
                addClick(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop, true);
                redraw();
            }
        });
        
        canvas.addEventListener("mousedown", function(e) {
            paint = true;
            addClick(e.pageX - jQuery("#canvasDiv").offset().left, e.pageY - jQuery("#canvasDiv").offset().top);
            redraw();
        });
        
        canvas.addEventListener("mousemove", function(e) {
            if (paint) {
                addClick(e.pageX - jQuery("#canvasDiv").offset().left, e.pageY - jQuery("#canvasDiv").offset().top, true);
                redraw();
            }
        });
        
        canvas.addEventListener("mouseup", function(e) {
            paint = false;
        });
        
        canvas.addEventListener("mouseleave", function(e) {
            paint = false;
        });
        
        document.getElementById("btn_clear").addEventListener("click", function() {
            canvas.width = canvas.width;
        });
        
        document.getElementById("btn_cancel").addEventListener("click", function() {
            $("#overlay").css("display", "none")
        });
        
        jQuery(window).resize(function(){
            var screenwidth = (window.innerWidth > 0) ? window.innerWidth : screen.width;
            var screenheight = (window.innerHeight > 0) ? window.innerHeight : screen.height;
            canvas.setAttribute('width', screenwidth);
            canvas.setAttribute('height', screenheight);
        });


        	
        jQuery( "#btn_submit").click(function() {
            // select canvas elements
           var sourceCanvas = document.getElementById("canvas");
           var destCanvas = document.getElementById('artifact').contentWindow.document.getElementById(jQuery("#txt_openBiggerItemID").val()).getElementsByClassName('jSignature')[0];

           //copy canvas by DataUrl
           var sourceImageData = sourceCanvas.toDataURL("image/png");
           var destCanvasContext = destCanvas.getContext('2d');
           destCanvas.width = destCanvas.width;
           var destinationImage = new Image;
           destinationImage.onload = function() {
               destCanvasContext.drawImage(destinationImage, 0, 0, destCanvas.width, destCanvas.height);
           };
           destinationImage.src = sourceImageData;
           jQuery(jQuery('#artifact').contents().find('input[name='+ jQuery("#txt_openBiggerItemName").val() +']')[0]).val(sourceImageData);
           jQuery("#overlay").css("display", "none");
           
       });
        
        function onDocumentTouchStart(event) {
            if (event.touches.length == 1) {
                event.preventDefault();
                // Faking double click for touch devices
                var now = new Date().getTime();
                if (now - timeOfLastTouch < 250) {
                    reset();
                    return;
                }
                timeOfLastTouch = now;
                mouseX = event.touches[0].pageX;
                mouseY = event.touches[0].pageY;
                isMouseDown = true;
            }
        }
        
        function onDocumentTouchMove(event) {
            if (event.touches.length == 1) {
                event.preventDefault();
                mouseX = event.touches[0].pageX;
                mouseY = event.touches[0].pageY;
            }
        }
        
        function onDocumentTouchEnd(event) {
            if (event.touches.length == 0) {
                event.preventDefault();
                isMouseDown = false;
            }
        }
        
        var clickX = new Array();
        var clickY = new Array();
        var clickDrag = new Array();
        var paint;
        
        function addClick(x, y, dragging) {
            clickX.push(x);
            clickY.push(y);
            clickDrag.push(dragging);
        }
        
        function redraw() {
            //canvas.width = canvas.width; // Clears the canvas
            var FSignatureSetting = $('#artifact').get(0).contentWindow.getFSignatureSetting();
            context.strokeStyle = FSignatureSetting.color;
            context.lineJoin = "round";
            var sourceCanvas = document.getElementById("canvas");
            context.lineWidth = 10;
            while (clickX.length > 0) {
                point.bx = point.x;
                point.by = point.y;
                point.x = clickX.pop();
                point.y = clickY.pop();
                point.drag = clickDrag.pop();
                context.beginPath();
                if (point.drag && point.notFirst) {
                    context.moveTo(point.bx, point.by);
                } else {
                    point.notFirst = true;
                    context.moveTo(point.x - 1, point.y);
                }
                context.lineTo(point.x, point.y);
                context.closePath();
                context.stroke();
            }
        }
</script>
        
    </div>
    <!-- end AF-7378 -->
        
        	<!-- EIP2016/skins/default/tiles/nav.jsp -->













<nav class="navbar-default navbar-static-side" role="navigation" style="">
    <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 100%;"><div class="sidebar-collapse" style="overflow: hidden; width: auto; height: 100%;">
        <ul class="nav metismenu fr_layout_menu_sortable fr_layout_menu_draggable_connect" id="side-menu" style="display: none;">
            <li class="nav-header fr_nav-header fr_layout_menu_sortable_item_disable">
            	<div class="fr_nav_logo_frame">
					<a href="https://pnt16.apitech.com.tw/WebAgenda/index.do">
					    <!-- modified for UP-1622 -->
						<img class="center-block" data-src="ShowLoginImage?reLoadCache=1754887468000&amp;type=logo&amp;themeId=TMT0000000000000" src="./應用程式表單_files/ShowLoginImage">
					</a>
				</div>
            	<!-- EIP2016/skins/default/components/user.jsp -->



















<!-- AF-6535 add by abin 20180907 -->





<script>
    jQuery(document).ready(function() {
        initUserModal();
    });
    
    function initUserModal() {
        
    }
    
    var isDeputy = 'false';
    
    var isReassignDeputiedTask = 'false';
    var isLogin = 'null';
    var isOpenFormByMailLoginWithNTLMorAzureSSO = 'null';
    var isSendBackDeputyTasks = 'false'; 
    //if (!false) {//AF-4244
    if (!false && !("true" == isOpenFormByMailLoginWithNTLMorAzureSSO) && !false) {//AF-6176, add by Raul; modify by fenping.zou,for AF-8242 //AF-8452 modify by jun 2023-06-15
        if (isLogin == "true" && isDeputy == "true") {
            eipToast({
                message: '您目前已經啟動代理人機制，\n是否要將其關閉？',
                method: 'warning',
                antiColor: true,
                timeOut: 5000,
                showConfirmButton: true,
                confirmButtonText: '是',
                showCloseButton: true,
                closeButtonText: '否',
                confirmButtonCallback: function() {
                    loginChangeDeputy();
                },
                //add by zhaoyang AF-6991
                closeButtonCallback: function() {
                    loginKeepDeputy();
                }
            });
        } else if (isLogin == "true" && isReassignDeputiedTask == "true") {
            if (isSendBackDeputyTasks == "false") { //add by zhaoyang AF-8059
                eipToast({
                    message: '您的待辦事項中目前有代理他人的工作，\n是否要將該工作送回原處理人？',
                    method: 'warning',
                    antiColor: true,
                    timeOut: 5000,
                    showConfirmButton: true,
                    confirmButtonText: '是',
                    showCloseButton: true,
                    closeButtonText: '否',
                    confirmButtonCallback: function() {
                        loginrRassignDeputiedTask();
                    }
                });
            } else {
                this.window.location = getURL("ReassignDeputiedTask.do?executeReassign=true");
            }
        }
    }
    
    function loginChangeDeputy() {
        this.window.location = getURL("ChangeDeputy.do?closeDeputy=true");
    }
    
    function loginrRassignDeputiedTask() {
        //this.window.location = getURL("ReassignDeputiedTask.do?executeReassigntrue=");//remove for AF-7648
        this.window.location = getURL("ReassignDeputiedTask.do?executeReassign=true");//AF-7648
    }
    
    function checkSupportBrowseAndOpenWindow(url, title, width, height) {
        var ieVersion = getInternetExplorerVersion();//function's defined in system.js
         if (ieVersion != -1 && ieVersion <= 10) {
             eipToast('請使用 Internet Explorer 11 以上的瀏覽器版本\n以確保獲得最完整的功能。');
             return;
         }
         openWindowCenter(url, title, width, height);
    }
    
    //add by zhaoyang AF-6991
    function loginKeepDeputy() {
        eipToast({
            message: '是否將已暫停的工作轉給代理人？',
            method: 'warning',
            antiColor: true,
            timeOut: 5000,
            showConfirmButton: true,
            confirmButtonText: '是',
            showCloseButton: true,
            closeButtonText: '否',
            confirmButtonCallback: function() {
                sendTaskToDeputy();
            }
        });
    }
    
    function sendTaskToDeputy() {
        this.window.location = getURL("SendTaskToDeputy.do");
    }
    //end AF-6991
    
    
    
    
    
        $('#theme-style').remove();
        $('body').append('<link type="text/css" id="theme-style" rel="stylesheet" href="EIP2016/style/theme/TMT0000000000000.css?reLoadCache=1754887472000">');
    
    var defaultThemeID = "TMT0000000000000";
    var colorThemeListModalSaved = false;//used in this page and editTheme.jsp and themeList.jsp
    function showLeaveColorPopover(){
        colorThemeListModalSaved = false;
        eipModal({
            id: 'colorThemeListModal',
            sizeClass: 'modal-sm',
            title: '主題切換',
            url: 'colorThemeTemplate.do',
            urlData:{ 
                action: 'themeList'
            },
            showButton1: true,
            button1Icon: 'fa-check',
            button1Class: 'btn-primary',
            button1Callback: function() {//save
                colorThemeListModalSaved = true;
                var themeId = $('#colorThemeListModal .theme_list i.fa-check').parent().attr('data-theme-id');
                $.post('colorThemeTemplate.do',{'action':'saveUserTheme','themeID':themeId},function(jdata){
                    $('#theme-style').remove();
                    if(jdata.success=='true'){
                        $('body').append('<link type="text/css" id="theme-style" rel="stylesheet" href="EIP2016/style/theme/'+jdata.themeID+'.css?reLoadCache=1754887472000">');
                        eipToast({'message':'切換主題成功!','method':'success'});
                        if(defaultThemeID != jdata.themeID){
                            defaultThemeID = jdata.themeID;
                            var logoImg = "ShowLoginImage?type=logo&themeId=" + defaultThemeID + "&reLoadCache=1754887468000"; // modified for UP-1622
                            $('#side-menu .fr_nav_logo_frame img:first').attr({'src':logoImg, 'data-src':logoImg});
                        }
                    }else{
                        if(defaultThemeID!=''){
                            $('body').append('<link type="text/css" id="theme-style" rel="stylesheet" href="EIP2016/style/theme/'+defaultThemeID+'.css?reLoadCache=1754887472000">');
                        }
                        var logoImg = "ShowLoginImage?type=logo&themeId=" + defaultThemeID + "&reLoadCache=1754887468000"; // modified for UP-1622
                        $('#side-menu .fr_nav_logo_frame img:first').attr({'src':logoImg, 'data-src':logoImg});
                        
                        eipToast('切換主題失敗!');
                        return;
                    }
                },'json');
            },
            closeModalCallback: function() {//reset only when cancel
                if(!colorThemeListModalSaved){
                    $('#theme-style').remove();
                    if(defaultThemeID!=''){
                        $('body').append('<link type="text/css" id="theme-style" rel="stylesheet" href="EIP2016/style/theme/'+defaultThemeID+'.css">');
                        var logoImg = "ShowLoginImage?type=logo&themeId=" + defaultThemeID + "&reLoadCache=1754887468000"; // modified for UP-1622
                        $('#side-menu .fr_nav_logo_frame img:first').attr({'src':logoImg, 'data-src':logoImg});
                    }
                }
            },
            modalBackdrop: 'static',//UP-1423 add by abin 20180814
            destroy: true
        });
    }

    
</script>




<!-- skins/default/components/userConfigMenuUtil.jsp -->







<script type="text/javascript">
	function showOneMemberEncode() { // Since AF4.0 Modify by Jared 20150820
		var url1 = getURL('/showOneMember.do');
		var url2 = '?key=';
		var url3 = 'ZjZnb1Nya2N6WTg5L3JLdEVMRzBzTHRMemRyRXp5ZllqU1o3S2xUSFN4cVJmSDBLaW53b0hVaENLb0lVdUFkUlRnMjJheHQyc0o3ag0KTndwWktGRVM5dz09DQpXJiQjIUE1NXFzdlZZZWk1WT0NCg';
		var url = url1 + url2 + url3;
	
		window.location = url;
	}
	
	function showAgentEncode() { // Since AF4.0 Modify by Jared 20150826
		var url = getURL('/Agent.do');
		
		window.location = url;
	}
	/*
	function showDeviceEncode() { // Since AF4.0 Modify by Jared 20150826
		var url = getURL('/deviceManagement.do');
		var title = '智慧裝置管理' ; 
		var defaultButtonText = '關閉';
		var options = 
			{
				'title'				: title,
		        'isScroll'			: 'yes',
		        'isResizable'		: true,
		        'width'				: 700,
		        'height'			: 600,
		        'minWidth'			: 700,
		        'defaultButtonText'	: defaultButtonText,
		        'specificBehaviorOptions':
			    	{
		        		isDefaultButton 	: true
			    	}
			};
		openDialog(url, options);//[AF-5200]
	}
	*/
	function showOnlineType(type) {
		var url = '';
		var text = '';
		if (type === 'onlineUser') {
			text = '線上人員';
			url = getURL('/OnlineUser.do');//[AF-5200]
		} else if (type === 'taskUser') {
			text = '流程人數';
			url = getURL('/OnlineUser.do?type=taskUser');//[AF-5200]
		}
		
		eipModal({
			id: 'showOnlineModal',
			sizeClass: 'modal-lg',
			title: text,
			url: url,
			destroy: true
		});
	}
	
	function showWebAdm(url) { // Since AF4.0 Modify by Jared 20150826
		var title = 'WebAdm'; 
		var defaultButtonText = '關閉';
		var options = 
			{
				'title'				: title,
		        'isScroll'			: 'yes',
		        'isResizable'		: true,
		        'width'				: 1280,
		        'height'			: 768,
		        'minWidth'			: 1280,
		        'defaultButtonText'	: defaultButtonText,
		        'specificBehaviorOptions':
			    	{
		        		isDefaultButton 	: true
			    	}
			};
		openDialog(url, options);//[AF-5200]
	}
	
	function showWebOrg(url, title) { // Since AF4.0 Modify by Jared 20150826
		var defaultButtonText = '關閉';
		var options = 
			{
				'title'				: title,
		        'isScroll'			: 'yes',
		        'isResizable'		: true,
		        'width'				: 1280,
		        'height'			: 768,
		        'minWidth'			: 1280,
		        'defaultButtonText'	: defaultButtonText,
		        'specificBehaviorOptions':
			    	{
		        		isDefaultButton 	: true
			    	}
			};
		openDialog(url, options);//[AF-5200]
	}
	function showMfp() { // AF-7803 add by Miles 20210728
		var url = getURL('/multiFuncDBProcessManager.do');
		window.open(url, 'MFP', 'height=600,width=1280,top=0,left=0');
	}
	function showLaleSysConfig() { // LEP-219 add by Miles
	    var url = getURL('/LaleSysConfigRedirect.do');
        window.location = url;
    }
	function showRpaConfig() { // AF-8821 add by Miles
	    var url = getURL('/RpaRedirect.do');
        window.location = url;
    }
</script>
<div class="dropdown profile-element">
    <div>
        <div class="fr_circle_image_wrap fr_div_bottom">
            <div class="fr_circle_image_opacity"></div>
            <img class="fr_circle_image profilePhotoImage" alt="image" src="./應用程式表單_files/downloadPhoto">
        </div>
        
    
    </div>
    
    <a data-toggle="dropdown" class="dropdown-toggle" href="https://pnt16.apitech.com.tw/WebAgenda/#">
        <span class="clear">
            <span class="block m-t-xs">
                <strong class="font-bold">
                    cal002
                </strong>
            </span>
            <span class="text-muted text-xs block">
                Engineer
                <b class="caret"></b>
            </span>
        </span>
    </a>
    <ul class="dropdown-menu animated fadeInRight m-t-xs">
        <!-- AF-6535 add by abin 20180907 -->
            <li><a onclick="showOneMemberEncode()">個人設定</a></li>
        
        <!-- AF-6535 add by abin 20180907 -->
            <li><a onclick="showAgentEncode()">代理人設定</a></li>
        
        
        <!-- AF-6535 add by abin 20180907 -->
            <li><a data-toggle="modal" data-target="#showOnlineDialog" onclick="showOnlineType(&#39;onlineUser&#39;)">線上人員</a></li>
        
        
        
        
        
		
        
        <!-- LEP-219 add by Miles -->
        
        <!-- AF-8001 當智雲管理權限時(含一級、二級)，也可使用此功能  @moya2022-04-28 14:51 -->
        
        <!-- AF-8821 by Miles -->
        
        <li class="hide" id="li_tabsLayout"></li><!-- by Change -->
        <li class="hide" id="li_tabsMobileLayout"></li><!-- by Change -->
        <li class="hide" id="li_switchMobile"></li><!-- by Change -->
        <!-- AF-6535 add by abin 20180907 -->
            <li class="divider"></li>
        
        <li><a href="https://pnt16.apitech.com.tw/WebAgenda/logout.do">登出</a></li>
    </ul>
</div>



            </li>
            <!-- EIP2016/skins/default/tiles/menus.jsp -->



















 







<!-- AF-8105, modified by tammyyang (add charset="UTF-8" to complement the security of content-type setting) -->
<link type="text/css" charset="UTF-8" rel="stylesheet" href="./應用程式表單_files/menu.css">

<script>
	//UP-1952 luke , 
	//if openMethod is "newTab" or "newWindow" , remove href and add click event redirectToExternalLinkURL
	const layoutMenuNoLinkURL = '此選單無可用連結!';

	
	function redirectToExternalLinkURL(element,id,openMethod,width,height,inModificationMode,indexPath) {		
		if("false" == inModificationMode && "true" == $(element).attr("show-external-url")){			
			var redirectURL = "redirectExternalLinkURL.jsp?id="+id;//AF-7562
			//AF-8168 modify by wenchao 開新分頁或者新視窗前檢查是否 time out，若有超時則讓頁面返回到登錄頁
			jQuery.ajax({
				url:'checkTimeOut.do?from=menus',
				dataType:'json',
				type:'post',
				success:function(data){
					if (!data.success) {
						if ("newTab" == openMethod) {	 			
				 			window.open('index.do', '_blank');	 			
				 		} else if ("newWindow" == openMethod) {	 			
				 			var configStr = 'height='+height+',width='+width;
				 			window.open('index.do', '_blank', config=configStr);	 			
				 		}
					} else {
						if ("newTab" == openMethod) {	 			
				 			window.open(redirectURL, '_blank');	 			
				 		} else if ("newWindow" == openMethod) {	 			
				 			var configStr = 'height='+height+',width='+width;
				 			window.open(redirectURL, '_blank', config=configStr);	 			
				 		}
					}
				},
				error:function(data){
					if ("newTab" == openMethod) {	 			
			 			window.open('index.do', '_blank');	 			
			 		} else if ("newWindow" == openMethod) {	 			
			 			var configStr = 'height='+height+',width='+width;
			 			window.open('index.do', '_blank', config=configStr);	 			
			 		}
				}
			});
			/*
	 		if ("newTab" == openMethod) {	 			
	 			window.open(redirectURL, '_blank');	 			
	 		} else if ("newWindow" == openMethod) {	 			
	 			var configStr = 'height='+height+',width='+width;
	 			window.open(redirectURL, '_blank', config=configStr);	 			
	 		}
			*/
			//end for AF-8168
	 		expandPageWhenOpenNewWindow($(element),indexPath);
		}		
		element.setAttribute("show-external-url","true");
	}	
	//UP-1952 luke , 
	//click is link to lower level page , need expand menu to lower level page and set class active
	function expandPageWhenOpenNewWindow(element,indexPath) {				
		//check next level page is exist
		var indexPathArray = indexPath.split(",");		
		var indexNext = indexPathArray[0];
		if('-1' == indexNext || '' == indexNext){
			//set this to active
			$(element).parent('li').attr('class','active');				
			removeOtherElementClassActive(element);
			return ;
		}
		//next level page is exist , check need expand or not
		var isExpand = $(element).attr('aria-expanded');
		var isExpandByURL = $(element).parent('li').hasClass('active');				
		if( 'false' == isExpand || (undefined === isExpand && false == isExpandByURL)){
			$(element).children('.arrow').first().click();
		}
		var elementNext_a  = $(element).parent('li').children('ul').children('li').eq(indexNext).children('a');
		var indexPathNext = indexPathArray.slice(1,indexPathArray.length).join(',');		
		window.setTimeout(expandPageWhenOpenNewWindow , 400 , elementNext_a , indexPathNext );		 
	}
	
	//UP-1952 luke , 
	//after expand menu path , remove other active class which not on expand path
	function removeOtherElementClassActive(element){	
		var parents = $(element).parents('li.active');
		var allActiveLi = $('li.active');		
		var i,j;
		for (i = 0; i < allActiveLi.length; i++) {			
			
			if($(allActiveLi[i]).hasClass('fr_layout_menu_layout') || '' == $(allActiveLi[i]).attr('id')){//UP-1952
				continue ;
			}

			var activeLiId = $(allActiveLi[i]).attr('id');			
							
			for (j = 0; j < parents.length; j++) {
				var parentID = $(parents[j]).attr('id');
				if(activeLiId == parentID){
					break;
				}
				
				// after check , allActiveLi[i] not in parents , remove active
				if(j == parents.length-1){					
					$(allActiveLi[i]).removeClass('execute');
					$(allActiveLi[i]).removeClass('active');
					$(allActiveLi[i]).children('a').attr('aria-expanded', false);
					$(allActiveLi[i]).children('ul').removeClass('in');
					//$(allActiveLi[i]).children('ul').metisMenu().hide();
				}
			}		 
		}
	}
	// add by Miles 20210727
		
</script>
<!-- AF-8105, modified by tammyyang (add charset="UTF-8" to complement the security of content-type setting) -->
<script type="text/javascript" charset="UTF-8" src="./應用程式表單_files/menu(1).js.下載"></script>


	
	
		
				
	<li data-menu-group-id="" id="fr_layout_menu_home" class="fr_layout_menu  fr_layout_menu_sortable_item fr_layout_menu_tab_sortable_parent  "><!-- "fr_layout_menu_" + id to avoid the id as same from portlets.jsp. -->
		
		
									
		
		
		  
 		<a href="https://pnt16.apitech.com.tw/WebAgenda/displayTab.do?tabIndex=0" style="" class="" show-external-url="true"> 

			
			<i class="fas fa-home"></i>
			<span class="fr_layout_menu_title">
				預設版面
			</span>
			
					<span class="fa arrow fr_arrow_button"></span>
				
		</a>
		
				<ul id="fr_layout_menu_page_ul_home" class="nav nav-second-level fr_layout_menu_page_ul   collapse" aria-expanded="false"><!-- UP-1992,luke,20191224 -->
			
							<li id="fr_layout_menu_LAY000000000001" class="fr_layout_menu_layout active"><!-- "fr_layout_menu_" + id to avoid the id as same from portlets.jsp. -->
								<a href="javascript:saveDefaultEIPLayout(&#39;LAY000000000001&#39;)" style="">
									預設版面
								</a>
							</li>
			
				</ul>
		
	</li>

	
	
		
				
	<li data-menu-group-id="GRP000000000001" id="fr_layout_menu_process" class="fr_layout_menu  fr_layout_menu_sortable_item active execute fr_layout_menu_hide_child_ul"><!-- "fr_layout_menu_" + id to avoid the id as same from portlets.jsp. -->
		
		
		<div name="favoritePage_imgDiv" style="float: left;padding-left: 0px;display: none">
			
			<img id="img_process" src="./應用程式表單_files/star_2.png" onclick="favoritePage(&#39;process&#39;)">
			
		</div>
		
									
		
		
		  
 		<a href="https://pnt16.apitech.com.tw/WebAgenda/displayTab.do?tabIndex=1" style="" class="" show-external-url="true"> 

			
			<i class="fas fa-cogs"></i>
			<span class="fr_layout_menu_title">
				流程作業
			</span>
				
		</a>
		
	</li>

	
	
		
				
	<li data-menu-group-id="GRP000000000005" id="fr_layout_menu_resources" class="fr_layout_menu  fr_layout_menu_sortable_item  "><!-- "fr_layout_menu_" + id to avoid the id as same from portlets.jsp. -->
		
		
		<div name="favoritePage_imgDiv" style="float: left;padding-left: 0px;display: none">
			
			<img id="img_resources" src="./應用程式表單_files/star_2.png" onclick="favoritePage(&#39;resources&#39;)">
			
		</div>
		
									
		
		
		  
 		<a href="https://pnt16.apitech.com.tw/WebAgenda/displayTab.do?tabIndex=2" style="" class="" show-external-url="true"> 

			
			<i class="fas fa-inbox"></i>
			<span class="fr_layout_menu_title">
				企業資源
			</span>
			
					<span class="fa arrow fr_arrow_button"></span>
				
		</a>
		
				<ul id="fr_layout_menu_page_ul_resources" class="nav nav-second-level fr_layout_menu_page_ul  fr_layout_menu_sortable  collapse" aria-expanded="false"><!-- UP-1992,luke,20191224 -->
			
							<li data-menu-group-id="GRP000000000005" id="fr_layout_menu_employee" class="fr_layout_menu  fr_layout_menu_sortable_item  fr_layout_menu_hide_child_ul"><!-- "fr_layout_menu_" + id to avoid the id as same from portlets.jsp. -->

								
									<div style="float:left;padding-left: 5px;display: none;" name="favoritePage_imgDiv">
										
											<img id="img_employee" src="./應用程式表單_files/star_2.png" onclick="favoritePage(&#39;employee&#39;)">
										
									</div>
								
								
								 
 								<a href="https://pnt16.apitech.com.tw/WebAgenda/displayPage.do?tabIndex=2&amp;pageIndex=0" style="" class="" show-external-url="true"> 								
									
									<i class="fas fa-user"></i>
									<span class="fr_layout_menu_title">員工資訊</span>
										
								</a>
								
							</li>
			
				</ul>
		
	</li>





        </ul>
    </div><div class="slimScrollBar" style="background: rgb(0, 0, 0); width: 7px; position: absolute; top: 0px; opacity: 0.4; display: none; border-radius: 7px; z-index: 99; right: 1px; height: 957px;"></div><div class="slimScrollRail" style="width: 7px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 7px; background: rgb(51, 51, 51); opacity: 0.9; z-index: 90; right: 1px;"></div></div>
</nav>

        
        <div id="page-wrapper" class="gray-bg dashbard-1" style="min-height: 897px;">
			
				<!-- EIP2016/skins/default/tiles/header.jsp -->


















<!-- add by fenping.zou,for AF-7014_v2 -->
<script type="text/javascript">
//取出session里存的「左側工具列原來的收合狀態」,和當前「左側工具列的收合狀態」比較,不一致則調整
var originalNavbarState = 'false';
var currentNavbarState = jQuery('body').hasClass('mini-navbar').toString();//true:menuBar closed
var isMobileWidth = (($(window).width() < 769) ? true : false );	
var specialNavbarCheck = 'acbel'; //AF-8472 add by Sylvia


//AF-8472 add by Sylvia
if (originalNavbarState == 'null' && specialNavbarCheck == 'CDF' && !isMobileWidth) {
	setTimeout(function() {
		$("#side-menu").hide();
		$("body").addClass("mini-navbar");//設定為非預設值
	}, 100);
	
}
//AF-8472 end

if(originalNavbarState != 'null'){
	if(originalNavbarState != currentNavbarState){
		$("body").addClass("mini-navbar");//設定為非預設值
		//AF-7459,手機介面的時候,頁簽列預設是關閉的,列表是顯示的,桌機介面的時候,頁簽列預設是開啟的,列表是顯示的
		//所以手機介面 非預設值時 應展開頁簽列 應要顯示頁簽列內容,桌機介面 非預設值時 應縮起頁簽列 且可不顯示頁簽列內容避免破碎顯示
		if(!isMobileWidth ) { 
			$("#side-menu").hide();//解決「左側工具列已被收起來 ，表單點“儲存”或“送出”後，左側工具列 破碎顯示」的問題
		} else {
			$("#side-menu").show();
		}
	}
}
//AF-7459手機模式開啟時會有頁簽破碎,如果頁簽列展開為預設值(不展開)時，隱藏頁簽列內容
if( isMobileWidth && (originalNavbarState == currentNavbarState || originalNavbarState == 'null') ) { 
	$("#side-menu").hide();
}
</script>
<!-- end for AF-7014_v2 -->

<div class="row border-bottom">
	<nav class="navbar navbar-fixed-top white-bg fr_overflow-hidden-xs" role="navigation" style="margin-bottom: 0;height:60px;">
	<div class="navbar-header 
		
     	
     			col-xs-10 col-sm-9 
     	
		col-md-8" style="padding-left: 0;padding-right: 0; 
		 
		 
		 
		">
	    <a class="navbar-minimalize minimalize-styl-2 btn btn-primary"><i class="fas fa-bars"></i> </a>
		
	    <h2 style="margin-top: 14px;line-height: 30px;font-size: 24px;margin-left: 0;padding-left:15px;" class="fr-text-overflow-ellipsis">
	    	
		    	
					
					
						應用程式表單
					
				
	    	
	    </h2>
	    <form role="search" class="navbar-form-custom hide" action="https://pnt16.apitech.com.tw/WebAgenda/search_results.html">
	        <div class="form-group">
	            <input type="text" placeholder="Search..." class="form-control" name="top-search" id="top-search">
	        </div>
	    </form>
	</div>
	    <ul class="nav navbar-top-links navbar-right text-center">
	    
<!-- AF-8472 add by sylvia -->

<!-- AF-8472 end-->
	        
            
            
	    	
			
	        <li class="hidden-xs">
	            <a href="https://pnt16.apitech.com.tw/WebAgenda/logout.do">
	                <span class="welcome-message">
	                	<i class="fas fa-sign-out-alt"></i>
	                	登出
	            	</span>
	            </a>
	        </li>
	    </ul>
	</nav>
</div>




			
			
			
			<div class="row">
				
				
					<div id="eformHeader" class="container-fluid bg-info" style="padding: 0px;">
						<div>
							<!-- /eform/aphtmleformmenu.jsp -->






<!-- AF-6709, add by AlbertRyu -->

<div id="eform-menu" class="btn-group" style="padding: 10px; pointer-events: auto; cursor: auto;"> <!-- AF-6709, modified by AlbertRyu -->
	
		<button type="button" class="btn btn-default" onclick="javascript:location.href=&#39;index.do&#39;">
			<img src="./應用程式表單_files/back.gif">
			返回
		</button>
	
	<!-- 列印 -->
	<div class="btn-group">
		<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" name="PrintItem">
			<img src="./應用程式表單_files/printer.png">
			<span class="hidden-xs">列印控制</span>
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu">
			<li>
				
				<a href="javascript:checkSessionTimeout(&#39;printForm&#39;);" class="funcion_bar_link" name="Printform" style=""><img src="./應用程式表單_files/printer.png" border="0" style="vertical-align:middle;padding:3px;" title="列印"><!-- modified for AF-5970 -->
					列印
				</a>
			</li>
			<li>
				<a href="javascript:this.frames.artifact.checkSessionTimeout(&#39;pageFormatSetup&#39;);" class="funcion_bar_link" name="PrintFormatSetup" style=""><img src="./應用程式表單_files/printstyle.png" border="0" style="vertical-align:middle;padding:3px;" title="格式"><!-- modified for AF-5970 -->
					格式
				</a>
			</li>
			<li>
				<a href="javascript:this.frames.artifact.checkSessionTimeout(&#39;PrintModeSetup&#39;);" class="funcion_bar_link" name="PrintModeSetup" style=""> <!-- modified for AF-5970 -->
					<img src="./應用程式表單_files/printmode.png" border="0" style="vertical-align:middle;padding:3px;" title="模式">
					模式
				</a>
			</li>
		</ul>
	</div>
</div>

<form name="printModeSettings">
    <input type="hidden" id="PrintMode" name="PrintMode" value="Pdf">
    <input type="hidden" id="PrintPage" name="PrintPage" value="CutPage">
    <input type="hidden" id="PrintFooter" name="PrintFooter" value="true">
    <input type="hidden" id="PrintBarCode" name="PrintBarCode" value="true"><!-- AF-5007, add by Joe -->
    <input type="hidden" id="PrintAdjust" name="PrintAdjust" value="true">
    <input type="hidden" id="HideBtnCmp" name="HideBtnCmp" value="false">
    <input type="hidden" id="PdfTextAntialiasOff" name="PdfTextAntialiasOff" value="false"><!-- ELITE-177 -->
    <input type="hidden" id="withSignRecords" name="withSignRecords" value="newpage"><!-- 3.7 HotFix AF-3878 -->
</form>
<script>
	/*
    function printForm(){
        this.frames.artifact.doPrintAction();
        var type = document.forms[0].PrintMode.value;
        var printPage = document.forms[0].PrintPage.value;
        var printFooter = document.forms[0].PrintFooter.value;
        var printAdjust = document.forms[0].PrintAdjust.value;
        var pdfTextAntialiasOff = document.forms[0].PdfTextAntialiasOff.value;// ELITE-177
        var withSignRecords = document.forms[0].withSignRecords.value;//3.7 HotFix AF-3878
        if (type == "Java") {
            this.frames.artifact.artPrint();
        } else if (type == "JpgFile") {
            // ELITE-177
            var url = "/htmlformprintservlet?id="+this.frames.artifact.artInsId+"&type=JPG&printAdjust="+printAdjust+"&pdfTextAntialiasOff="+pdfTextAntialiasOff + "&withSignRecords=" + withSignRecords;
            window.open(getURL(url), "Reference","toolbar=no ,menubar=no, resizable=yes, scrollbars=yes, left=100, top=100, width=600, height=400, status=yes");
        } else {
            // ELITE-177
            var url = "/htmlformprintservlet?id="+this.frames.artifact.artInsId+"&type=PDF&printPage="+printPage+"&printFooter="+printFooter+"&printAdjust="+printAdjust+"&pdfTextAntialiasOff="+pdfTextAntialiasOff + "&withSignRecords=" + withSignRecords;
            window.open(getURL(url), "Reference","toolbar=no ,menubar=no, resizable=yes, scrollbars=yes, left=100, top=100, width=600, height=400, status=yes");
        }
    }
    */
    
    function printForm() {
        this.frames.artifact.doPrintAction();
        if ( !this.frames.artifact.ajaxForm ) {
        	_PrintForm();
        }
    }
    
    function _PrintForm() {
        /*
        var type = document.forms[0].PrintMode.value;
        var printPage = document.forms[0].PrintPage.value;
        var printFooter = document.forms[0].PrintFooter.value;
        var printBarCode = document.forms[0].PrintBarCode.value;//AF-5007, add by Joe
        var printAdjust = document.forms[0].PrintAdjust.value;
        var pdfTextAntialiasOff = document.forms[0].PdfTextAntialiasOff.value;//ELITE-177
        var withSignRecords = document.forms[0].withSignRecords.value;//3.7 HotFix AF-3878
        */
        //modify by zhaoyang AF-6331
        var type = document.forms["printModeSettings"].PrintMode.value;
        /* AF-7471 marked by @moya2020-07-07 18:21 --- START
        var printPage = document.forms["printModeSettings"].PrintPage.value;
        var printFooter = document.forms["printModeSettings"].PrintFooter.value;
        var printBarCode = document.forms["printModeSettings"].PrintBarCode.value;//AF-5007, add by Joe
        var printAdjust = document.forms["printModeSettings"].PrintAdjust.value;
        var pdfTextAntialiasOff = document.forms["printModeSettings"].PdfTextAntialiasOff.value;//ELITE-177
        var withSignRecords = document.forms["printModeSettings"].withSignRecords.value;//3.7 HotFix AF-3878
        **  AF-7471 marked by @moya2020-07-07 18:21 --- END */
        //var encArtInsID = this.frames.artifact.encArtInsIDForAP;
        //var url = "/htmlformprintservlet?key="+encArtInsID; 
        //modify by zhaoyang AF-7227
        var url = getHtmlPrintUrl();
        
        //alert("pring jsp: " + type);
        if (type == "Java") {
            this.frames.artifact.artPrint();
        } else if (type == "JpgFile") {
        	//var url = "/htmlformprintservlet?id="+this.frames.artifact.artInsId+"&type=JPG&printAdjust="+printAdjust;
            window.open(getURL(url), "Reference","toolbar=no ,menubar=no, resizable=yes, scrollbars=yes, left=100, top=100, width=600, height=400, status=yes");
        } else if (type == "PdfFile") {
            //ELITE-177
            //var url = "/htmlformprintservlet?id="+this.frames.artifact.artInsId+"&type=PdfFile&printPage="+printPage+"&printFooter="+printFooter+"&printBarCode="+printBarCode+"&printAdjust="+printAdjust+"&pdfTextAntialiasOff="+pdfTextAntialiasOff + "&withSignRecords=" + withSignRecords;
            window.open(getURL(url), "Reference","toolbar=no ,menubar=no, resizable=yes, scrollbars=yes, left=100, top=100, width=600, height=400, status=yes");
        } else {
            //ELITE-177
            //var url = "/htmlformprintservlet?id="+this.frames.artifact.artInsId+"&type=PDF&printPage="+printPage+"&printFooter="+printFooter+"&printBarCode="+printBarCode+"&printAdjust="+printAdjust+"&pdfTextAntialiasOff="+pdfTextAntialiasOff + "&withSignRecords=" + withSignRecords;	//AF-5007, modify by Joe
            window.open(getURL( url ), "Reference","toolbar=no ,menubar=no, resizable=yes, scrollbars=yes, left=100, top=100, width=600, height=400, status=yes");
        }
    }
    
    function checkSessionTimeout(fromScript) {
        var f = document.getElementById("hiddenframe");
        f.src = urlBase + "CheckSessionTimeout.do?from=" + fromScript +"&formStyle=HTMLPRINT";
        //-- 下面的寫法與其他portal整合時可能會有問題,請參考AEPP-909的詳細說明!
        //parent.frames['hiddenframe'].location = urlBase + "CheckSessionTimeout.do;jsessionid=" + jsessionid + "?from=" + fromScript +"&formStyle=HTMLPRINT";
    }
    
    //add by zhaoyang AF-7227
    function getHtmlPrintUrl() {
        var widths = "";
        var heights = "";
        var array = [];
        var scrollHead = jQuery(document.getElementsByTagName("iframe")[0].contentWindow.document).find(".dataTables_scrollHead");
        if (scrollHead.length > 0) { //ajax 表單和智慧表單 Datatables
            for (var n = 0; n < scrollHead.length; n++) {
                var id = jQuery(jQuery(scrollHead[n]).parent().parent().next()).attr("data-itemid");
                var heads = jQuery(scrollHead[n]).find("th");
                if (null != heads && heads.length > 0) {
                    widths = widths + id + ":";
                    heights = heights + id + ":";
                    var realHeight = parseInt(jQuery(heads[0]).outerHeight());
                    for (var i = 0; i < heads.length; i++) {
                    	if (jQuery(heads[i]).css("display") == "none") { //add by zhaoyang AF-7825
                            continue;
                        } else {
	                        var realWidth = parseInt(jQuery(heads[i]).outerWidth());
	                        widths = widths + realWidth + ",";                        	
                        }
                    }
                    heights = heights + realHeight +";";
                    widths += ";";
                }
            }
        } else { //一般表單
            var frames = document.getElementsByTagName("iframe")[0].contentWindow.document.getElementsByTagName("iframe");
            for (var i = 0; i < frames.length; i++) {
                var id = frames[i].id;
                try {
                    array = jQuery(frames[i].contentWindow.document).find("#tableDiv").find("tr[class='defaultListTitle']").find("th");
                } catch (e) {
                    continue;
                }
                
                if (null != array && array.length > 0) {
                    widths = widths + id + ":";
                    heights = heights + id + ":";
                    var realHeight = parseInt(jQuery(array[0]).outerHeight());
                    realHeight += Math.round((realHeight - 6) / 16.9) * 3;
                    for (var m = 0; m < array.length; m++) {
                        if (jQuery(array[m]).html().indexOf('delete.gif') != -1 || jQuery(array[m]).css("display") == "none") { //modify by zhaoyang AF-7825
                            continue;
                        }
                        var realWidth = parseInt(jQuery(array[m]).outerWidth());
                        widths = widths + realWidth + ",";
                    }
                    heights = heights + realHeight +";";
                    widths += ";";
                } else {
                    var tabframe = frames[i].contentWindow.document.getElementById("tableBodyIframe");
                    if (tabframe == null) {
                        continue;
                    }
                    array = jQuery(tabframe.contentWindow.document).find(".fht-tbody").find("tr[class='tableHeader']").find("td[id^='header_']");
                    if (null != array && array.length > 0) {
                        widths = widths + id + ":";
                        heights = heights + id + ":";
                        var realHeight = parseInt(jQuery(array[0]).outerHeight());
                        realHeight += Math.round((realHeight - 6) / 16.9) * 3;
                        for (var m = 0; m < array.length; m++) {
                        	if (jQuery(array[m]).css("display") == "none") { //add by zhaoyang AF-7825
                                continue;
                            } else {
	                            var realWidth = parseInt(jQuery(array[m]).outerWidth());
	                            widths = widths + realWidth + ",";                            	
                            }
                        }
                        heights = heights + realHeight +";";
                        widths += ";";
                    } else {
                        continue;
                    }
                }
            }
        }
        var encArtInsID = this.frames.artifact.encArtInsIDForAP;
        var url = "/htmlformprintservlet?key="+encArtInsID + "&widths=" + widths + "&heights=" + heights;
        return url;
    }
</script>

							
						</div>
					</div>
				
				<div id="tile_body" style="overflow: auto; margin-bottom: 38px;">
					<!-- \EIP2016\eform\apartifact.jsp-->

















<script type="text/javascript" src="./應用程式表單_files/plugins.js.下載"></script>
<link type="text/css" rel="stylesheet" href="./應用程式表單_files/plugins.css">
<script>

// add by fenping.zou,for AF-7014_v2
// 在 表單內容 加載之前，若「左側工具列」還未被收合起來，則將「左側工具列」收合起來
//AF-7496,luke,20200716

if (!jQuery('body').hasClass('mini-navbar')) {
	$("body").addClass("mini-navbar");//AF-7496,luke,20200716,let artifact all not in Mobile Mode
}
/*
if( isMobileWidth ) {
	if (jQuery('body').hasClass('mini-navbar')) {
		$("body").removeClass("mini-navbar");	
	}
} else {
	if (!jQuery('body').hasClass('mini-navbar')) {
		$("body").addClass("mini-navbar");
	}
}*/
//AF-7496,luke,20200716 END
// 解決「開表單後，左側工具列 破碎顯示」的問題
$("#side-menu").hide();
// end for AF-7014_v2

var messageTitle = '訊息';//add by fenping.zou,for AF-6772
jQuery(document).ready(function() {
	
	// add by fenping.zou,for AF-7933
    // 【按下 Enter 鍵，關閉 modal 視窗】功能
    jQuery(document).keypress(function() {
        if (event.keyCode == 13) {
            jQuery(".modal").find(".close").click();
        }
    });
    // end for AF-7933
	
    if (true) { // AF-7284, add by AlbertRyu
        showIFrameSpinner();
    }
    // add by fenping.zou,for AF-7014
	jQuery('#artifact').load(function(){
	    hideIFrameSpinner(); // AF-7284, add by AlbertRyu
	    /* remove by fenping.zou,for AF-7014_v2
	    if (!jQuery('body').hasClass('mini-navbar')) {
			// trigger the sidebar to hide itself
			jQuery('.navbar-minimalize').click();
		}
	    */
		//add by fenping.zou,for AF-7016
		jQuery('#tile_body').css("overflow", "auto");
		jQuery('#tile_body').css("margin-bottom", "38px");
        jQuery('.fr_iframe_container').css("margin-bottom", "20px");//AF-6913
		//end for AF-7016
		
		//added by Shihwei,for AF-7016
        
		       setTimeout(function () {
		           $("#tile_body").floatingScroll();
		       }, 1200);// wait for UP3 side bar to be hidden
        
      	//end for AF-7016
	});
	// end for AF-7014
	var ifrWidth = jQuery('#artifact').attr('width');
	jQuery('#GradientLayout_m').css('min-width', ifrWidth + 'px');//modify by yanli AF-8244 給 div 最小寬度
    var isFullForm = true; // AF-6709, add by AlbertRyu
});

// AF-7284, add by AlbertRyu
function showIFrameSpinner() {
    jQuery('#artifact').before('<div id="iframeSpinner"><img src="/WebAgenda/image/ajax-loader.gif"/></div>');
}

// AF-7284, add by AlbertRyu
function hideIFrameSpinner() {
    jQuery('#iframeSpinner').hide();
}

</script>
<!-- 請注意!! 若增加工具列按鈕要特別測所有瀏覽器會不會引發 AF-3649類似問題, 解法可參考AF-3649 -->
<!--add by Change AF-3583 -->
  <script type="text/javascript">
//add by Change AF-3649
      var isNonExitAction = false;
      jQuery(document).ready(function () {
      jQuery(".funcion_bar_link").hover( 
             function(){isNonExitAction = true;},
             function(){isNonExitAction = false;}
            );
      });
  //end
    window.onbeforeunload = function () {
        var artifactIframe = document.getElementById('artifact');
        var innerDoc = (artifactIframe.contentDocument) ? artifactIframe.contentDocument : artifactIframe.contentWindow.document;
        var dynamicForm = innerDoc.getElementById("DynamicForm");
        if (null != dynamicForm){
            var artInsID = dynamicForm.elements.ArtInsIDSYS.value;

            if (!(true == isNonExitAction)) {
                jQuery.ajax ({
                    url: urlBase + "removeInsAttribute.do",
                    data: {"artInsID":artInsID},
                    type: "post",
                    dataType: "json",
                    async: false
                });
            }
        }    
    }
  </script>
<!--end AF-3583 -->

<div class="fr_iframe_container" style="width: 100%; margin-left: 3px; padding: 6px 4px; margin-bottom: 20px;">
<table border="0" cellspacing="0" cellpadding="0" width="100%">
  
  
    <tbody><tr>
      <td align="center" height="15" width="100%">      </td>
    </tr>
  
  <tr>
    <td align="center" width="100%" valign="top">
      <div id="iframeSpinner" style="display: none;"><img src="./應用程式表單_files/ajax-loader.gif"></div><iframe id="artifact" name="artifact" type="content" src="./應用程式表單_files/preAction.html" width="1222" height="515" scrolling="no" frameborder="0" style="border: 0px solid black;">      </iframe>
    </td>
  </tr>
</tbody></table>
</div>
<!-- add by yhtseng, 2004/01/13 -->
<iframe id="hiddenframe" name="hiddenframe" src="./應用程式表單_files/saved_resource.html" width="0" height="0" scrolling="no" style="border-width: 0;"></iframe>
<!-- end add by yhtseng --><!-- add by AF-4050 -->
	<script type="text/javascript">
		
			function reHeadWidthSize(totalWidth) {
				// add by AF-4050
				var windowWidth = jQuery(window).width();
				if (totalWidth.indexOf('px') != -1) {
					totalWidth = totalWidth.substring(0, totalWidth.indexOf('px'));
				}
				totalWidth = parseInt(totalWidth);
				windowWidth = parseInt(windowWidth);
				if (totalWidth > 1024 && totalWidth > windowWidth) {
					jQuery('#navi').css('width', totalWidth + 'px');
					jQuery('#maxPageHeight').css('width', totalWidth + 'px');
					jQuery('#header').css('width', totalWidth + 'px');
				} else if (totalWidth > 1024 && totalWidth <= windowWidth || totalWidth <= 1024) {
					jQuery('#navi').css('width', '100%');
					jQuery('#maxPageHeight').css('width', '100%');
					jQuery('#header').css('width', '100%');
				}
			}
			reHeadWidthSize('1222');
			
	</script>
<!-- end by AF-4050 -->
				<div class="fl-scrolls fl-scrolls-hidden" style="width: 1905px; left: 0px;"><div style="width: 1908px;"></div></div><div class="fl-scrolls fl-scrolls-hidden" style="width: 1905px; left: 0px;"><div style="width: 1908px;"></div></div><div class="fl-scrolls fl-scrolls-hidden" style="width: 1905px; left: 0px;"><div style="width: 1908px;"></div></div><div class="fl-scrolls fl-scrolls-hidden" style="width: 1905px; left: 0px;"><div style="width: 1908px;"></div></div></div>
				
					
					

<div class="footer">
<!--  Comment out UP-2187 Sylvia -->
<!--  
    <div>
        &copy;2018 UniPortal. Flowring Technology Corp.All rights reserved. 
    </div>
    -->
</div>
				
			</div>
		</div>
	</div><link type="text/css" id="theme-style" rel="stylesheet" href="./應用程式表單_files/TMT0000000000000.css">
	<div class="_modal"></div> <!-- add by yanli AF-8155 -->


&gt;

</body><!-- modify by AF-8499 --></html>